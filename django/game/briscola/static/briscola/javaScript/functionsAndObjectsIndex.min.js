function helloUser(a){window.location="#popup1"}function popUp2(a,b){document.getElementById("registerLoginPopUpTitle").innerHTML=a,document.getElementById("registerLoginPopUp").innerHTML=b,window.location="#popup2"}function fireWebSocket(a){a.preventDefault(),console.log("sockets");var b="wss://echo.websocket.org/";websocket=new WebSocket(b),websocket.onopen=function(a){onOpen(a)},websocket.onclose=function(a){onClose(a)},websocket.onmessage=function(a){onMessage(a)},websocket.onerror=function(a){onError(a)}}function onOpen(a){console.log("CONNECTED"),console.log(document.getElementById("loginUsername").value),doSend(document.getElementById("loginUsername").value)}function onClose(a){console.log("DISCONNECTED")}function onMessage(a){document.getElementById("userHello").innerHTML=a.data,helloUser(),console.log('<span style="color: blue;">RESPONSE: '+a.data+"</span>"),websocket.close(),this.removeEventListener("click",eventLoginBtn),setTimeout(function(){document.getElementById("loginForm").submit()},2e3)}function onError(a){console.log("Error "+a.data)}function doSend(a){console.log("SENT: "+a),websocket.send(a)}function checkUser(a,b,c){basePath="./dataBase/users.json";var d=new XMLHttpRequest;d.addEventListener("load",function(){if(users=JSON.parse(this.responseText),passwordUser=users[a],void 0!==passwordUser&&passwordUser.trim()===b){localStorage.setItem("user",a);try{fireWebSocket(c)}catch(a){this.removeEventListener("click",eventLoginBtn),setTimeout(function(){document.getElementById("loginForm").submit()},2e3)}}else popUp2("Warning","Wrong username or password")},!1),d.open("GET",basePath),d.responseType="text",d.send()}function userRegisterChecking(a,b){basePath="./dataBase/users.json";var c=new XMLHttpRequest;c.addEventListener("load",function(){users=JSON.parse(this.responseText),passwordUser=users[a],void 0===passwordUser?popUp2("Wellcome!","Verify your mail and start <span>playing<span>!"):popUp2("Warning","Need to choose different username.")},!1),c.open("GET",basePath),c.responseType="text",c.send()}function loginSubmitAction(a){var b=document.getElementById("loginUsername").value,c=document.getElementById("loginPwd").value;a.preventDefault(),checkUser(b,c,a)}function registerSubmitAction(a){a.preventDefault();var b=document.getElementById("registerUsername").value;document.getElementById("registerPwd").value,document.getElementById("registerEmail").value;userRegisterChecking(b,a)}appearLoginSection=function(a){var b=document.getElementsByClassName("loginRegister")[0];console.log(b.style.display),""===b.style.display||"none"===b.style.display?(b.style.display="flex",b.style.flexFlow="column"):b.style.display="none"},setTheStartOftheGame=function(a){"undefined"!=typeof Storage&&localStorage.setItem("start",!0)};